[![NPM Version](https://badgen.net/npm/v/minion-js?color=red&icon=npm&label=version)](https://npmjs.com/package/minion-js)
[![Github License](https://badgen.net/github/license/lamualfa/minion?color=purple&label=license)](https://github.com/lamualfa/minion/blob/master/LICENSE)
![CI](https://github.com/lamualfa/minion/workflows/CI/badge.svg)
[![codecov](https://codecov.io/gh/lamualfa/minion/branch/master/graph/badge.svg?token=NZ6VHIHJJV)](https://codecov.io/gh/lamualfa/minion)
[![Maintainability](https://api.codeclimate.com/v1/badges/cd4f513ac8e1652b1b7c/maintainability)](https://codeclimate.com/github/lamualfa/minion/maintainability)

# Quick Start

- [Whats is Minion?](#what-is-minion)
- [Installation](#installation)
- [Usage](#usage)
  - [Options](#options)
- [Features](#features)
  - [Automatically generates Sourcemap](#automatically-generates-sourcemap)
  - [Ignore replacement](#ignore-replacement)
- [Concepts](#concepts)
  - [Class Maps](#class-maps)
  - [Extractor](#extractor)
  - [Writer](#writer)
- [Integrations](#integrations)
  - [Extractor](https://github.com/lamualfa/minion#extractor-1)
    - [PostCSS](https://github.com/lamualfa/minion#extractor-1)
  - [Writer](https://github.com/lamualfa/minion#writer-1)
    - [Rollup](https://github.com/lamualfa/minion#writer-1)
- [More Examples](#more-examples)

# What is Minion?

Minion is a tool used to change selectors in the Javascript code based on the [Class Maps](#class-maps) that passing in options.

## Example:

**Class Maps**

Whats is Class Maps? See [Class Maps](#class-maps).

```js
{
  'text-4xl': 'a',
  'font-medium': 'b',
  'absolute': 'c',
  'rounded': 'd'
}
```
> Example using Tailwind CSS Class

**Javascript Input**

```js
document.getElementById('title').classList.add('text-4xl', 'font-medium')
document.getElementById('modal').classList.add('rounded', 'absolute')
document.getElementById('banner').classList.add('rounded')
```

**After processing with Minion**
```js
document.getElementById('title').classList.add('a', 'b')
document.getElementById('modal').classList.add('d', 'c')
document.getElementById('banner').classList.add('d')
```

<hr>

# Installation

```bash
# NPM
npm i minion-js --save-dev

# Yarn
yarn add -D minion-js
```

<hr>

# Usage

```js
import createMinion from 'minion-js'

const minion = createMinion({
  // In real case, Class Maps will automatically generated by Extractor.
  getClassMaps: () => ({
    'bg-gray-100': 'a',
    'border-3': 'b',
    'mt-2': 'c',
  })
})

const originalCode = `
document.getElementById('box').classList.add(['bg-gray-100']);
document.getElementsByClassName('mt-2');
console.log('border-3')
`
const modifiedCode = minion(originalCode)

console.log(modifiedCode.code)
```

**Output**

```js
document.getElementById('box').classList.add(['a']);
document.getElementsByClassName('b');
console.log('c')
```

## Options

### `sourcemap: boolean`

If `true`, `minion-js` will generate a sourcemap from the modified code. Default `true`.

### `classMapsFieldName: string`

Field name used to retrieve Class Maps data from the `global` object. Default `classMaps`.

### `getClassMaps: () => object`

Have your own Class Maps? Please pass through this function.

<hr>

# Features

## Automatically generates Sourcemap

Need a [sourcemap](https://trackjs.com/blog/debugging-with-sourcemaps)? Relax, `minion-js` will automatically create it for you.

## Ignore replacement

You can exclude some code from being modified by this package using inline-comment. The comment is `minion-disable` and `minion-enable`.

### Example

**Class Maps**
```js
{
  'object-cover': 'a',
  relative: 'b'
}
```

**Input**
```js
// minion-disable
const someDescription = 'Gravity relative to the mass of the object.'
// minion-enable
const imageClass = 'relative object-cover rounded'
```
> See "relative" word after "Gravity" word

**Output**
```js
// minion-disable
const someDescription = 'Gravity relative to the mass of the object.'
// minion-enable
const imageClass = 'a b rounded'
```
> Nothing has changed from the `someDescription` variable

<hr>

# Concepts

## Class Maps

Object that contains the data set to replace. In real case, this object will automatically generated by [Extractor](#extractor).

### Format
```js
{
  '<target>': '<substitute>'
}
```

#### Example

```js
{
  absolute: 'a',
  relative: 'b',
  block: 'c'
}
```

- `absolute` will be change to `a`.
- `relative` will be change to `b`.
- `block` will be change to `c`.


## Extractor

Part that will generate the [Class Maps](#class-maps) from the existing CSS file.

### Example

**CSS**

```css
.text-black {
  color: black;
}

.italic {
  font-style: italic;
}
```

**Will be converted to Class Maps by Extractor**

```js
{
  'text-black': 'a',
  'italic': 'b'
}
```

## Writer

The section that writes the [Class Maps](#class-maps) from the [Extractor](#extractor) to the build code.

> `minion-js` is writer for Javascript code.

<hr>

# Integrations

## Extractor

 - PostCSS - [postcss-minion](https://github.com/lamualfa/postcss-minion)

## Writer
 - Javascript - minion-js (_You are here_)

 - Rollup - [rollup-plugin-minion](https://github.com/lamualfa/rollup-plugin-minion)
 - Rollup HTML - rollup-plugin-minion-html (_Coming soon. PR welcome._)

 - Webpack - minion-loader (_Coming soon. PR welcome._)
 - Webpack HTML - minion-html-loader (_Coming soon. PR welcome._)

<hr>

# More Examples

Need more examples? See [minion-examples](https://github.com/lamualfa/minion-examples).